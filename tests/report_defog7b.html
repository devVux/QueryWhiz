<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title id="head-title">report.html</title>
      <style type="text/css">body {
  font-family: Helvetica, Arial, sans-serif;
  font-size: 12px;
  /* do not increase min-width as some may use split screens */
  min-width: 800px;
  color: #999;
}

h1 {
  font-size: 24px;
  color: black;
}

h2 {
  font-size: 16px;
  color: black;
}

p {
  color: black;
}

a {
  color: #999;
}

table {
  border-collapse: collapse;
}

/******************************
 * SUMMARY INFORMATION
 ******************************/
#environment td {
  padding: 5px;
  border: 1px solid #e6e6e6;
  vertical-align: top;
}
#environment tr:nth-child(odd) {
  background-color: #f6f6f6;
}
#environment ul {
  margin: 0;
  padding: 0 20px;
}

/******************************
 * TEST RESULT COLORS
 ******************************/
span.passed,
.passed .col-result {
  color: green;
}

span.skipped,
span.xfailed,
span.rerun,
.skipped .col-result,
.xfailed .col-result,
.rerun .col-result {
  color: orange;
}

span.error,
span.failed,
span.xpassed,
.error .col-result,
.failed .col-result,
.xpassed .col-result {
  color: red;
}

.col-links__extra {
  margin-right: 3px;
}

/******************************
 * RESULTS TABLE
 *
 * 1. Table Layout
 * 2. Extra
 * 3. Sorting items
 *
 ******************************/
/*------------------
 * 1. Table Layout
 *------------------*/
#results-table {
  border: 1px solid #e6e6e6;
  color: #999;
  font-size: 12px;
  width: 100%;
}
#results-table th,
#results-table td {
  padding: 5px;
  border: 1px solid #e6e6e6;
  text-align: left;
}
#results-table th {
  font-weight: bold;
}

/*------------------
 * 2. Extra
 *------------------*/
.logwrapper {
  max-height: 230px;
  overflow-y: scroll;
  background-color: #e6e6e6;
}
.logwrapper.expanded {
  max-height: none;
}
.logwrapper.expanded .logexpander:after {
  content: "collapse [-]";
}
.logwrapper .logexpander {
  z-index: 1;
  position: sticky;
  top: 10px;
  width: max-content;
  border: 1px solid;
  border-radius: 3px;
  padding: 5px 7px;
  margin: 10px 0 10px calc(100% - 80px);
  cursor: pointer;
  background-color: #e6e6e6;
}
.logwrapper .logexpander:after {
  content: "expand [+]";
}
.logwrapper .logexpander:hover {
  color: #000;
  border-color: #000;
}
.logwrapper .log {
  min-height: 40px;
  position: relative;
  top: -50px;
  height: calc(100% + 50px);
  border: 1px solid #e6e6e6;
  color: black;
  display: block;
  font-family: "Courier New", Courier, monospace;
  padding: 5px;
  padding-right: 80px;
  white-space: pre-wrap;
}

div.media {
  border: 1px solid #e6e6e6;
  float: right;
  height: 240px;
  margin: 0 5px;
  overflow: hidden;
  width: 320px;
}

.media-container {
  display: grid;
  grid-template-columns: 25px auto 25px;
  align-items: center;
  flex: 1 1;
  overflow: hidden;
  height: 200px;
}

.media-container--fullscreen {
  grid-template-columns: 0px auto 0px;
}

.media-container__nav--right,
.media-container__nav--left {
  text-align: center;
  cursor: pointer;
}

.media-container__viewport {
  cursor: pointer;
  text-align: center;
  height: inherit;
}
.media-container__viewport img,
.media-container__viewport video {
  object-fit: cover;
  width: 100%;
  max-height: 100%;
}

.media__name,
.media__counter {
  display: flex;
  flex-direction: row;
  justify-content: space-around;
  flex: 0 0 25px;
  align-items: center;
}

.collapsible td:not(.col-links) {
  cursor: pointer;
}
.collapsible td:not(.col-links):hover::after {
  color: #bbb;
  font-style: italic;
  cursor: pointer;
}

.col-result {
  width: 130px;
}
.col-result:hover::after {
  content: " (hide details)";
}

.col-result.collapsed:hover::after {
  content: " (show details)";
}

#environment-header h2:hover::after {
  content: " (hide details)";
  color: #bbb;
  font-style: italic;
  cursor: pointer;
  font-size: 12px;
}

#environment-header.collapsed h2:hover::after {
  content: " (show details)";
  color: #bbb;
  font-style: italic;
  cursor: pointer;
  font-size: 12px;
}

/*------------------
 * 3. Sorting items
 *------------------*/
.sortable {
  cursor: pointer;
}
.sortable.desc:after {
  content: " ";
  position: relative;
  left: 5px;
  bottom: -12.5px;
  border: 10px solid #4caf50;
  border-bottom: 0;
  border-left-color: transparent;
  border-right-color: transparent;
}
.sortable.asc:after {
  content: " ";
  position: relative;
  left: 5px;
  bottom: 12.5px;
  border: 10px solid #4caf50;
  border-top: 0;
  border-left-color: transparent;
  border-right-color: transparent;
}

.hidden, .summary__reload__button.hidden {
  display: none;
}

.summary__data {
  flex: 0 0 550px;
}
.summary__reload {
  flex: 1 1;
  display: flex;
  justify-content: center;
}
.summary__reload__button {
  flex: 0 0 300px;
  display: flex;
  color: white;
  font-weight: bold;
  background-color: #4caf50;
  text-align: center;
  justify-content: center;
  align-items: center;
  border-radius: 3px;
  cursor: pointer;
}
.summary__reload__button:hover {
  background-color: #46a049;
}
.summary__spacer {
  flex: 0 0 550px;
}

.controls {
  display: flex;
  justify-content: space-between;
}

.filters,
.collapse {
  display: flex;
  align-items: center;
}
.filters button,
.collapse button {
  color: #999;
  border: none;
  background: none;
  cursor: pointer;
  text-decoration: underline;
}
.filters button:hover,
.collapse button:hover {
  color: #ccc;
}

.filter__label {
  margin-right: 10px;
}

      </style>
    
  </head>
  <body>
    <h1 id="title">report.html</h1>
    <p>Report generated on 02-Sep-2024 at 12:07:38 by <a href="https://pypi.python.org/pypi/pytest-html">pytest-html</a>
        v4.1.1</p>
    <div id="environment-header">
      <h2>Environment</h2>
    </div>
    <table id="environment"></table>
    <!-- TEMPLATES -->
      <template id="template_environment_row">
      <tr>
        <td></td>
        <td></td>
      </tr>
    </template>
    <template id="template_results-table__body--empty">
      <tbody class="results-table-row">
        <tr id="not-found-message">
          <td colspan="4">No results found. Check the filters.</th>
        </tr>
    </template>
    <template id="template_results-table__tbody">
      <tbody class="results-table-row">
        <tr class="collapsible">
        </tr>
        <tr class="extras-row">
          <td class="extra" colspan="4">
            <div class="extraHTML"></div>
            <div class="media">
              <div class="media-container">
                  <div class="media-container__nav--left"><</div>
                  <div class="media-container__viewport">
                    <img src="" />
                    <video controls>
                      <source src="" type="video/mp4">
                    </video>
                  </div>
                  <div class="media-container__nav--right">></div>
                </div>
                <div class="media__name"></div>
                <div class="media__counter"></div>
            </div>
            <div class="logwrapper">
              <div class="logexpander"></div>
              <div class="log"></div>
            </div>
          </td>
        </tr>
      </tbody>
    </template>
    <!-- END TEMPLATES -->
    <div class="summary">
      <div class="summary__data">
        <h2>Summary</h2>
        <div class="additional-summary prefix">
        </div>
        <p class="run-count">20 tests took 00:18:50.</p>
        <p class="filter">(Un)check the boxes to filter the results.</p>
        <div class="summary__reload">
          <div class="summary__reload__button hidden" onclick="location.reload()">
            <div>There are still tests running. <br />Reload this page to get the latest results!</div>
          </div>
        </div>
        <div class="summary__spacer"></div>
        <div class="controls">
          <div class="filters">
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="failed" />
            <span class="failed">9 Failed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="passed" />
            <span class="passed">11 Passed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="skipped" disabled/>
            <span class="skipped">0 Skipped,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xfailed" disabled/>
            <span class="xfailed">0 Expected failures,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xpassed" disabled/>
            <span class="xpassed">0 Unexpected passes,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="error" disabled/>
            <span class="error">0 Errors,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="rerun" disabled/>
            <span class="rerun">0 Reruns</span>
          </div>
          <div class="collapse">
            <button id="show_all_details">Show all details</button>&nbsp;/&nbsp;<button id="hide_all_details">Hide all details</button>
          </div>
        </div>
      </div>
      <div class="additional-summary summary">
      </div>
      <div class="additional-summary postfix">
      </div>
    </div>
    <table id="results-table">
      <thead id="results-table-head">
        <tr>
          <th class="sortable" data-column-type="result">Result</th>
          <th class="sortable" data-column-type="testId">Test</th>
          <th class="sortable" data-column-type="duration">Duration</th>
          <th>Links</th>
        </tr>
      </thead>
    </table>
  </body>
  <footer>
    <div id="data-container" data-jsonblob="{&#34;environment&#34;: {&#34;Python&#34;: &#34;3.11.5&#34;, &#34;Platform&#34;: &#34;Windows-10-10.0.22631-SP0&#34;, &#34;Packages&#34;: {&#34;pytest&#34;: &#34;8.3.2&#34;, &#34;pluggy&#34;: &#34;1.5.0&#34;}, &#34;Plugins&#34;: {&#34;anyio&#34;: &#34;4.4.0&#34;, &#34;html&#34;: &#34;4.1.1&#34;, &#34;metadata&#34;: &#34;3.1.1&#34;}}, &#34;tests&#34;: {&#34;test_queries.py::test_query_1&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_1&#34;, &#34;duration&#34;: &#34;00:00:30&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_1&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:30&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nPrompt Find the number of orders with an article quantity of 0\nExpected  SELECT COUNT(*) FROM orders WHERE article_quantity = 0\nGenerated SELECT COUNT(*) FROM orders o WHERE o.article_quantity = 0;\n[[0]]\n[[0]]\n&#34;}], &#34;test_queries.py::test_query_2&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_2&#34;, &#34;duration&#34;: &#34;00:00:35&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_2&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:35&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;db_cursor = &amp;lt;cursor object at 0x000001E6F275ADC0; closed: 0&amp;gt;\n\n    def test_query_2(db_cursor):\n&amp;gt;       run_test(\n            db_cursor,\n            prompt=&amp;quot;Retrieve the names of all articles with a price higher than 100&amp;quot;,\n            expected_query=&amp;quot;SELECT DISTINCT article_name FROM orders WHERE article_price &amp;gt; 100&amp;quot;\n        )\n\ntest_queries.py:102: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntest_queries.py:91: in run_test\n    check_result(expected_result, generated_result)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nexpected = array([[&amp;#x27;Printer&amp;#x27;, &amp;#x27;Monitor&amp;#x27;, &amp;#x27;Laptop&amp;#x27;]], dtype=&amp;#x27;&amp;lt;U7&amp;#x27;), generated = array([[&amp;#x27;Laptop&amp;#x27;, &amp;#x27;Monitor&amp;#x27;, &amp;#x27;Printer&amp;#x27;, &amp;#x27;Laptop&amp;#x27;, &amp;#x27;Monitor&amp;#x27;, &amp;#x27;Printer&amp;#x27;]],\n      dtype=&amp;#x27;&amp;lt;U7&amp;#x27;)\n\n    def check_result(expected: tuple, generated: tuple):\n        expected = numpy.array(expected).T\n        generated = numpy.array(generated).T\n    \n        print(expected)\n        print(generated)\n    \n        for column in expected:\n&amp;gt;           assert column in generated\nE           ValueError: operands could not be broadcast together with shapes (1,6) (3,)\n\ntest_queries.py:46: ValueError\n\n----------------------------- Captured stdout call -----------------------------\nPrompt Retrieve the names of all articles with a price higher than 100\nExpected  SELECT DISTINCT article_name FROM orders WHERE article_price &amp;gt; 100\nGenerated SELECT o.article_name FROM orders o WHERE o.article_price &amp;gt; 100;\n[[&amp;#x27;Printer&amp;#x27; &amp;#x27;Monitor&amp;#x27; &amp;#x27;Laptop&amp;#x27;]]\n[[&amp;#x27;Laptop&amp;#x27; &amp;#x27;Monitor&amp;#x27; &amp;#x27;Printer&amp;#x27; &amp;#x27;Laptop&amp;#x27; &amp;#x27;Monitor&amp;#x27; &amp;#x27;Printer&amp;#x27;]]\n&#34;}], &#34;test_queries.py::test_query_3&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_3&#34;, &#34;duration&#34;: &#34;00:00:22&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_3&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:22&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nPrompt Find the maximum price of any article\nExpected  SELECT MAX(article_price) FROM orders\nGenerated SELECT MAX(o.article_price) AS max_price FROM orders o;\n[[999.99]]\n[[999.99]]\n&#34;}], &#34;test_queries.py::test_query_4&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_4&#34;, &#34;duration&#34;: &#34;00:00:31&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_4&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:31&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nPrompt Get the average quantity of articles with a price less than 50\nExpected  SELECT AVG(article_quantity) FROM orders WHERE article_price &amp;lt; 50\nGenerated SELECT AVG(o.article_quantity) FROM orders o WHERE o.article_price &amp;lt; 50;\n[[Decimal(&amp;#x27;1.5000000000000000&amp;#x27;)]]\n[[Decimal(&amp;#x27;1.5000000000000000&amp;#x27;)]]\n&#34;}], &#34;test_queries.py::test_query_5&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_5&#34;, &#34;duration&#34;: &#34;00:00:52&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_5&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:52&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;db_cursor = &amp;lt;cursor object at 0x000001E6F55D44A0; closed: 0&amp;gt;\n\n    def test_query_5(db_cursor):\n&amp;gt;       run_test(\n            db_cursor,\n            prompt=&amp;quot;List the names and prices of articles where the quantity is greater than the average quantity of all articles&amp;quot;,\n            expected_query=&amp;quot;SELECT DISTINCT article_name, article_price FROM orders WHERE article_quantity &amp;gt; (SELECT AVG(article_quantity) FROM orders)&amp;quot;\n        )\n\ntest_queries.py:123: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ntest_queries.py:91: in run_test\n    check_result(expected_result, generated_result)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nexpected = array([[&amp;#x27;Keyboard&amp;#x27;, &amp;#x27;Mouse&amp;#x27;, &amp;#x27;Printer&amp;#x27;, &amp;#x27;Laptop&amp;#x27;],\n       [&amp;#x27;75.0&amp;#x27;, &amp;#x27;25.5&amp;#x27;, &amp;#x27;149.95&amp;#x27;, &amp;#x27;999.99&amp;#x27;]], dtype=&amp;#x27;&amp;lt;U32&amp;#x27;)\ngenerated = array([[&amp;#x27;Mouse&amp;#x27;, &amp;#x27;Printer&amp;#x27;, &amp;#x27;Laptop&amp;#x27;, &amp;#x27;Keyboard&amp;#x27;],\n       [&amp;#x27;25.5&amp;#x27;, &amp;#x27;149.95&amp;#x27;, &amp;#x27;999.99&amp;#x27;, &amp;#x27;75.0&amp;#x27;]], dtype=&amp;#x27;&amp;lt;U32&amp;#x27;)\n\n    def check_result(expected: tuple, generated: tuple):\n        expected = numpy.array(expected).T\n        generated = numpy.array(generated).T\n    \n        print(expected)\n        print(generated)\n    \n        for column in expected:\n&amp;gt;           assert column in generated\nE           AssertionError: assert array([&amp;#x27;Keyboard&amp;#x27;, &amp;#x27;Mouse&amp;#x27;, &amp;#x27;Printer&amp;#x27;, &amp;#x27;Laptop&amp;#x27;], dtype=&amp;#x27;&amp;lt;U32&amp;#x27;) in array([[&amp;#x27;Mouse&amp;#x27;, &amp;#x27;Printer&amp;#x27;, &amp;#x27;Laptop&amp;#x27;, &amp;#x27;Keyboard&amp;#x27;],\\n       [&amp;#x27;25.5&amp;#x27;, &amp;#x27;149.95&amp;#x27;, &amp;#x27;999.99&amp;#x27;, &amp;#x27;75.0&amp;#x27;]], dtype=&amp;#x27;&amp;lt;U32&amp;#x27;)\n\ntest_queries.py:46: AssertionError\n\n----------------------------- Captured stdout call -----------------------------\nPrompt List the names and prices of articles where the quantity is greater than the average quantity of all articles\nExpected  SELECT DISTINCT article_name, article_price FROM orders WHERE article_quantity &amp;gt; (SELECT AVG(article_quantity) FROM orders)\nGenerated SELECT o.article_name, o.article_price FROM orders o WHERE o.article_quantity &amp;gt; (SELECT AVG(o2.article_quantity) FROM orders o2);\n[[&amp;#x27;Keyboard&amp;#x27; &amp;#x27;Mouse&amp;#x27; &amp;#x27;Printer&amp;#x27; &amp;#x27;Laptop&amp;#x27;]\n [&amp;#x27;75.0&amp;#x27; &amp;#x27;25.5&amp;#x27; &amp;#x27;149.95&amp;#x27; &amp;#x27;999.99&amp;#x27;]]\n[[&amp;#x27;Mouse&amp;#x27; &amp;#x27;Printer&amp;#x27; &amp;#x27;Laptop&amp;#x27; &amp;#x27;Keyboard&amp;#x27;]\n [&amp;#x27;25.5&amp;#x27; &amp;#x27;149.95&amp;#x27; &amp;#x27;999.99&amp;#x27; &amp;#x27;75.0&amp;#x27;]]\n&#34;}], &#34;test_queries.py::test_query_6&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_6&#34;, &#34;duration&#34;: &#34;00:00:48&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_6&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:48&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;db_cursor = &amp;lt;cursor object at 0x000001E6F55D4D60; closed: 0&amp;gt;\n\n    def test_query_6(db_cursor):\n&amp;gt;       run_test(\n            db_cursor,\n            prompt=&amp;quot;Count the number of distinct articles where the price is above the median price&amp;quot;,\n            expected_query=&amp;quot;SELECT COUNT(DISTINCT article_name) FROM orders WHERE article_price &amp;gt; (SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY article_price) FROM orders)&amp;quot;\n        )\n\ntest_queries.py:130: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ntest_queries.py:91: in run_test\n    check_result(expected_result, generated_result)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nexpected = array([[2]]), generated = array([[1]])\n\n    def check_result(expected: tuple, generated: tuple):\n        expected = numpy.array(expected).T\n        generated = numpy.array(generated).T\n    \n        print(expected)\n        print(generated)\n    \n        for column in expected:\n&amp;gt;           assert column in generated\nE           assert array([2]) in array([[1]])\n\ntest_queries.py:46: AssertionError\n\n----------------------------- Captured stdout call -----------------------------\nPrompt Count the number of distinct articles where the price is above the median price\nExpected  SELECT COUNT(DISTINCT article_name) FROM orders WHERE article_price &amp;gt; (SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY article_price) FROM orders)\nGenerated SELECT COUNT(DISTINCT o.article_code) FROM orders o WHERE o.article_price &amp;gt; (SELECT AVG(o2.article_price) FROM orders o2);\n[[2]]\n[[1]]\n&#34;}], &#34;test_queries.py::test_query_7&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_7&#34;, &#34;duration&#34;: &#34;00:00:55&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_7&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:55&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nPrompt Find the total number of orders placed by each client and sort them by the number of orders in descending order\nExpected  SELECT customer_name, customer_surname, COUNT(*) AS total_orders FROM orders GROUP BY customer_name, customer_surname ORDER BY total_orders DESC\nGenerated SELECT o.customer_code, o.customer_name, o.customer_surname, COUNT(o.code) AS total_orders FROM orders o GROUP BY o.customer_code, o.customer_name, o.customer_surname ORDER BY total_orders DESC;\n[[&amp;#x27;Mario&amp;#x27; &amp;#x27;Luigi&amp;#x27; &amp;#x27;Giulia&amp;#x27; &amp;#x27;Anna&amp;#x27; &amp;#x27;Marco&amp;#x27; &amp;#x27;Francesca&amp;#x27; &amp;#x27;Giuseppe&amp;#x27;]\n [&amp;#x27;Rossi&amp;#x27; &amp;#x27;Verdi&amp;#x27; &amp;#x27;Bianchi&amp;#x27; &amp;#x27;Neri&amp;#x27; &amp;#x27;Polo&amp;#x27; &amp;#x27;Rossi&amp;#x27; &amp;#x27;Ferrari&amp;#x27;]\n [&amp;#x27;2&amp;#x27; &amp;#x27;2&amp;#x27; &amp;#x27;2&amp;#x27; &amp;#x27;1&amp;#x27; &amp;#x27;1&amp;#x27; &amp;#x27;1&amp;#x27; &amp;#x27;1&amp;#x27;]]\n[[&amp;#x27;C002&amp;#x27; &amp;#x27;C003&amp;#x27; &amp;#x27;C001&amp;#x27; &amp;#x27;C004&amp;#x27; &amp;#x27;C005&amp;#x27; &amp;#x27;C007&amp;#x27; &amp;#x27;C006&amp;#x27;]\n [&amp;#x27;Luigi&amp;#x27; &amp;#x27;Giulia&amp;#x27; &amp;#x27;Mario&amp;#x27; &amp;#x27;Anna&amp;#x27; &amp;#x27;Giuseppe&amp;#x27; &amp;#x27;Marco&amp;#x27; &amp;#x27;Francesca&amp;#x27;]\n [&amp;#x27;Verdi&amp;#x27; &amp;#x27;Bianchi&amp;#x27; &amp;#x27;Rossi&amp;#x27; &amp;#x27;Neri&amp;#x27; &amp;#x27;Ferrari&amp;#x27; &amp;#x27;Polo&amp;#x27; &amp;#x27;Rossi&amp;#x27;]\n [&amp;#x27;2&amp;#x27; &amp;#x27;2&amp;#x27; &amp;#x27;2&amp;#x27; &amp;#x27;1&amp;#x27; &amp;#x27;1&amp;#x27; &amp;#x27;1&amp;#x27; &amp;#x27;1&amp;#x27;]]\n&#34;}], &#34;test_queries.py::test_query_8&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_8&#34;, &#34;duration&#34;: &#34;00:01:39&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_8&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:01:39&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;db_cursor = &amp;lt;cursor object at 0x000001E6EBD94E40; closed: 0&amp;gt;\n\n    def test_query_8(db_cursor):\n&amp;gt;       run_test(\n            db_cursor,\n            prompt=&amp;quot;Retrieve the minimum price of articles with quantities in the range 0-50, 51-100, and above 100&amp;quot;,\n            expected_query=&amp;quot;SELECT MIN(article_price) FROM orders WHERE article_quantity BETWEEN 0 AND 50 UNION ALL SELECT MIN(article_price) FROM orders WHERE article_quantity BETWEEN 51 AND 100 UNION ALL SELECT MIN(article_price) FROM orders WHERE article_quantity &amp;gt; 100&amp;quot;\n        )\n\ntest_queries.py:144: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ntest_queries.py:91: in run_test\n    check_result(expected_result, generated_result)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nexpected = array([[25.5, None, None]], dtype=object), generated = array([[&amp;#x27;A002&amp;#x27;, &amp;#x27;A003&amp;#x27;, &amp;#x27;A005&amp;#x27;, &amp;#x27;A004&amp;#x27;, &amp;#x27;A001&amp;#x27;],\n       [&amp;#x27;0-50&amp;#x27;, &amp;#x27;0-50&amp;#x27;, &amp;#x27;0-50&amp;#x27;, &amp;#x27;0-50&amp;#x27;, &amp;#x27;0-50&amp;#x27;],\n       [&amp;#x27;25.5&amp;#x27;, &amp;#x27;75.0&amp;#x27;, &amp;#x27;149.95&amp;#x27;, &amp;#x27;199.99&amp;#x27;, &amp;#x27;999.99&amp;#x27;]], dtype=&amp;#x27;&amp;lt;U32&amp;#x27;)\n\n    def check_result(expected: tuple, generated: tuple):\n        expected = numpy.array(expected).T\n        generated = numpy.array(generated).T\n    \n        print(expected)\n        print(generated)\n    \n        for column in expected:\n&amp;gt;           assert column in generated\nE           ValueError: operands could not be broadcast together with shapes (3,5) (3,)\n\ntest_queries.py:46: ValueError\n\n----------------------------- Captured stdout call -----------------------------\nPrompt Retrieve the minimum price of articles with quantities in the range 0-50, 51-100, and above 100\nExpected  SELECT MIN(article_price) FROM orders WHERE article_quantity BETWEEN 0 AND 50 UNION ALL SELECT MIN(article_price) FROM orders WHERE article_quantity BETWEEN 51 AND 100 UNION ALL SELECT MIN(article_price) FROM orders WHERE article_quantity &amp;gt; 100\nGenerated SELECT o.article_code, CASE WHEN o.article_quantity BETWEEN 0 AND 50 THEN &amp;#x27;0-50&amp;#x27; WHEN o.article_quantity BETWEEN 51 AND 100 THEN &amp;#x27;51-100&amp;#x27; ELSE &amp;#x27;above 100&amp;#x27; END AS quantity_range, MIN(o.article_price) AS min_price FROM orders o GROUP BY o.article_code, quantity_range ORDER BY min_price NULLS LAST;\n[[25.5 None None]]\n[[&amp;#x27;A002&amp;#x27; &amp;#x27;A003&amp;#x27; &amp;#x27;A005&amp;#x27; &amp;#x27;A004&amp;#x27; &amp;#x27;A001&amp;#x27;]\n [&amp;#x27;0-50&amp;#x27; &amp;#x27;0-50&amp;#x27; &amp;#x27;0-50&amp;#x27; &amp;#x27;0-50&amp;#x27; &amp;#x27;0-50&amp;#x27;]\n [&amp;#x27;25.5&amp;#x27; &amp;#x27;75.0&amp;#x27; &amp;#x27;149.95&amp;#x27; &amp;#x27;199.99&amp;#x27; &amp;#x27;999.99&amp;#x27;]]\n&#34;}], &#34;test_queries.py::test_query_9&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_9&#34;, &#34;duration&#34;: &#34;00:00:49&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_9&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:49&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;db_cursor = &amp;lt;cursor object at 0x000001E6F55D50E0; closed: 0&amp;gt;\n\n    def test_query_9(db_cursor):\n&amp;gt;       run_test(\n            db_cursor,\n            prompt=&amp;quot;Find the average price of articles where the quantity is higher than the 75th percentile of all quantities&amp;quot;,\n            expected_query=&amp;quot;SELECT AVG(article_price) FROM orders WHERE article_quantity &amp;gt; (SELECT PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY article_quantity) FROM orders)&amp;quot;\n        )\n\ntest_queries.py:151: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ntest_queries.py:84: in run_test\n    check_query(db_cursor, query.generated)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\ndb_cursor = &amp;lt;cursor object at 0x000001E6F55D50E0; closed: 0&amp;gt;, query = &amp;#x27;SELECT AVG(o.article_price) AS average_price FROM orders o WHERE o.article_quantity &amp;gt; (SELECT percentile_cont(0.75) within GROUP (ORDER BY o.article_quantity) FROM orders);&amp;#x27;\n\n    def check_query(db_cursor, query: str):\n        valid_syntax = True\n    \n        try:\n            db_cursor.execute(query)\n    \n        except Exception as e:\n            print(e)\n            db.connection.rollback()\n            valid_syntax = False\n    \n&amp;gt;       assert valid_syntax\nE       assert False\n\ntest_queries.py:75: AssertionError\n\n----------------------------- Captured stdout call -----------------------------\nERRORE:  le funzioni di aggregazione non sono ammesse in WHERE\nLINE 1: ... FROM orders o WHERE o.article_quantity &amp;gt; (SELECT percentile...\n                                                             ^\n\n&#34;}], &#34;test_queries.py::test_query_10&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_10&#34;, &#34;duration&#34;: &#34;00:01:02&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_10&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:01:02&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nPrompt Retrieve the names and prices of articles where the price is lower than the average price of articles with quantity above 20, and sort them by price in ascending order\nExpected  SELECT DISTINCT article_name, article_price FROM orders WHERE article_price &amp;lt; (SELECT AVG(article_price) FROM orders WHERE article_quantity &amp;gt; 20) ORDER BY article_price ASC\nGenerated SELECT o.article_name, o.article_price FROM orders o WHERE o.article_quantity &amp;gt; 20 AND o.article_price &amp;lt; (SELECT AVG(o2.article_price) FROM orders o2 WHERE o2.article_quantity &amp;gt; 20) ORDER BY o.article_price ASC;\n[]\n[]\n&#34;}], &#34;test_queries.py::test_query_11&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_11&#34;, &#34;duration&#34;: &#34;00:00:45&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_11&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:45&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nPrompt Find the most recent order date for each article\nExpected  SELECT article_name, MAX(date) AS most_recent_order FROM orders GROUP BY article_name\nGenerated SELECT o.article_code, o.article_name, MAX(o.date) AS latest_order_date FROM orders o GROUP BY o.article_code, o.article_name ORDER BY latest_order_date NULLS LAST;\n[[&amp;#x27;Printer&amp;#x27; &amp;#x27;Mouse&amp;#x27; &amp;#x27;Keyboard&amp;#x27; &amp;#x27;Monitor&amp;#x27; &amp;#x27;Laptop&amp;#x27;]\n [datetime.date(2024, 8, 10) datetime.date(2024, 8, 7)\n  datetime.date(2024, 8, 8) datetime.date(2024, 8, 9)\n  datetime.date(2024, 8, 6)]]\n[[&amp;#x27;A001&amp;#x27; &amp;#x27;A002&amp;#x27; &amp;#x27;A003&amp;#x27; &amp;#x27;A004&amp;#x27; &amp;#x27;A005&amp;#x27;]\n [&amp;#x27;Laptop&amp;#x27; &amp;#x27;Mouse&amp;#x27; &amp;#x27;Keyboard&amp;#x27; &amp;#x27;Monitor&amp;#x27; &amp;#x27;Printer&amp;#x27;]\n [datetime.date(2024, 8, 6) datetime.date(2024, 8, 7)\n  datetime.date(2024, 8, 8) datetime.date(2024, 8, 9)\n  datetime.date(2024, 8, 10)]]\n&#34;}], &#34;test_queries.py::test_query_12&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_12&#34;, &#34;duration&#34;: &#34;00:02:03&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_12&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:02:03&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nPrompt Retrieve the average quantity of articles for each customer, and only include customers who have placed more than 3 orders\nExpected  SELECT customer_name, customer_surname, AVG(article_quantity) AS avg_quantity FROM orders GROUP BY customer_name, customer_surname HAVING COUNT(*) &amp;gt; 3\nGenerated SELECT o.customer_code, o.customer_name, o.customer_surname, AVG(o.article_quantity) AS average_quantity FROM orders o GROUP BY o.customer_code, o.customer_name, o.customer_surname HAVING COUNT(o.code) &amp;gt; 3 ORDER BY average_quantity DESC NULLS LAST;\n[]\n[]\n&#34;}], &#34;test_queries.py::test_query_13&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_13&#34;, &#34;duration&#34;: &#34;00:00:49&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_13&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:49&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;db_cursor = &amp;lt;cursor object at 0x000001E6F55D5C40; closed: 0&amp;gt;\n\n    def test_query_13(db_cursor):\n&amp;gt;       run_test(\n            db_cursor,\n            prompt=&amp;quot;Find the total revenue generated from each article&amp;quot;,\n            expected_query=&amp;quot;SELECT article_name, SUM(article_price * article_quantity) AS total_revenue FROM orders GROUP BY article_name&amp;quot;\n        )\n\ntest_queries.py:179: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ntest_queries.py:91: in run_test\n    check_result(expected_result, generated_result)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nexpected = array([[&amp;#x27;Printer&amp;#x27;, &amp;#x27;Mouse&amp;#x27;, &amp;#x27;Keyboard&amp;#x27;, &amp;#x27;Monitor&amp;#x27;, &amp;#x27;Laptop&amp;#x27;],\n       [&amp;#x27;599.7999877929688&amp;#x27;, &amp;#x27;76.5&amp;#x27;, &amp;#x27;225.0&amp;#x27;, &amp;#x27;399.9800109863281&amp;#x27;,\n        &amp;#x27;2999.969970703125&amp;#x27;]], dtype=&amp;#x27;&amp;lt;U32&amp;#x27;)\ngenerated = array([[&amp;#x27;A001&amp;#x27;, &amp;#x27;A004&amp;#x27;, &amp;#x27;A005&amp;#x27;, &amp;#x27;A003&amp;#x27;, &amp;#x27;A002&amp;#x27;],\n       [&amp;#x27;Laptop&amp;#x27;, &amp;#x27;Monitor&amp;#x27;, &amp;#x27;Printer&amp;#x27;, &amp;#x27;Keyboard&amp;#x27;, &amp;#x27;Mouse&amp;#x27;],\n       [&amp;#x27;1999.98&amp;#x27;, &amp;#x27;399.98&amp;#x27;, &amp;#x27;299.9&amp;#x27;, &amp;#x27;150.0&amp;#x27;, &amp;#x27;51.0&amp;#x27;]], dtype=&amp;#x27;&amp;lt;U32&amp;#x27;)\n\n    def check_result(expected: tuple, generated: tuple):\n        expected = numpy.array(expected).T\n        generated = numpy.array(generated).T\n    \n        print(expected)\n        print(generated)\n    \n        for column in expected:\n&amp;gt;           assert column in generated\nE           AssertionError: assert array([&amp;#x27;Printer&amp;#x27;, &amp;#x27;Mouse&amp;#x27;, &amp;#x27;Keyboard&amp;#x27;, &amp;#x27;Monitor&amp;#x27;, &amp;#x27;Laptop&amp;#x27;], dtype=&amp;#x27;&amp;lt;U32&amp;#x27;) in array([[&amp;#x27;A001&amp;#x27;, &amp;#x27;A004&amp;#x27;, &amp;#x27;A005&amp;#x27;, &amp;#x27;A003&amp;#x27;, &amp;#x27;A002&amp;#x27;],\\n       [&amp;#x27;Laptop&amp;#x27;, &amp;#x27;Monitor&amp;#x27;, &amp;#x27;Printer&amp;#x27;, &amp;#x27;Keyboard&amp;#x27;, &amp;#x27;Mouse&amp;#x27;],\\n       [&amp;#x27;1999.98&amp;#x27;, &amp;#x27;399.98&amp;#x27;, &amp;#x27;299.9&amp;#x27;, &amp;#x27;150.0&amp;#x27;, &amp;#x27;51.0&amp;#x27;]], dtype=&amp;#x27;&amp;lt;U32&amp;#x27;)\n\ntest_queries.py:46: AssertionError\n\n----------------------------- Captured stdout call -----------------------------\nPrompt Find the total revenue generated from each article\nExpected  SELECT article_name, SUM(article_price * article_quantity) AS total_revenue FROM orders GROUP BY article_name\nGenerated SELECT o.article_code, o.article_name, SUM(o.article_price) AS total_revenue FROM orders o GROUP BY o.article_code, o.article_name ORDER BY total_revenue DESC NULLS LAST;\n[[&amp;#x27;Printer&amp;#x27; &amp;#x27;Mouse&amp;#x27; &amp;#x27;Keyboard&amp;#x27; &amp;#x27;Monitor&amp;#x27; &amp;#x27;Laptop&amp;#x27;]\n [&amp;#x27;599.7999877929688&amp;#x27; &amp;#x27;76.5&amp;#x27; &amp;#x27;225.0&amp;#x27; &amp;#x27;399.9800109863281&amp;#x27;\n  &amp;#x27;2999.969970703125&amp;#x27;]]\n[[&amp;#x27;A001&amp;#x27; &amp;#x27;A004&amp;#x27; &amp;#x27;A005&amp;#x27; &amp;#x27;A003&amp;#x27; &amp;#x27;A002&amp;#x27;]\n [&amp;#x27;Laptop&amp;#x27; &amp;#x27;Monitor&amp;#x27; &amp;#x27;Printer&amp;#x27; &amp;#x27;Keyboard&amp;#x27; &amp;#x27;Mouse&amp;#x27;]\n [&amp;#x27;1999.98&amp;#x27; &amp;#x27;399.98&amp;#x27; &amp;#x27;299.9&amp;#x27; &amp;#x27;150.0&amp;#x27; &amp;#x27;51.0&amp;#x27;]]\n&#34;}], &#34;test_queries.py::test_query_14&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_14&#34;, &#34;duration&#34;: &#34;00:00:38&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_14&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:38&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nPrompt Retrieve the names of articles that have never been ordered\nExpected  SELECT DISTINCT article_name FROM orders WHERE article_name NOT IN (SELECT DISTINCT article_name FROM orders)\nGenerated SELECT DISTINCT o.article_name FROM orders o WHERE o.code NOT IN (SELECT code FROM orders) ORDER BY o.article_name NULLS LAST;\n[]\n[]\n&#34;}], &#34;test_queries.py::test_query_15&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_15&#34;, &#34;duration&#34;: &#34;00:01:02&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_15&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:01:02&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;db_cursor = &amp;lt;cursor object at 0x000001E6F55D67A0; closed: 0&amp;gt;\n\n    def test_query_15(db_cursor):\n&amp;gt;       run_test(\n            db_cursor,\n            prompt=&amp;quot;Find the client who has spent the most on average per order&amp;quot;,\n            expected_query=&amp;quot;SELECT customer_name, customer_surname, AVG(article_price * article_quantity) AS avg_spent_per_order FROM orders GROUP BY customer_name, customer_surname ORDER BY avg_spent_per_order DESC LIMIT 1&amp;quot;\n        )\n\ntest_queries.py:193: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ntest_queries.py:91: in run_test\n    check_result(expected_result, generated_result)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nexpected = array([[&amp;#x27;Giuseppe&amp;#x27;],\n       [&amp;#x27;Ferrari&amp;#x27;],\n       [&amp;#x27;1999.97998046875&amp;#x27;]], dtype=&amp;#x27;&amp;lt;U32&amp;#x27;), generated = array([[&amp;#x27;C005&amp;#x27;],\n       [&amp;#x27;Giuseppe&amp;#x27;],\n       [&amp;#x27;Ferrari&amp;#x27;],\n       [&amp;#x27;999.989990234375&amp;#x27;]], dtype=&amp;#x27;&amp;lt;U32&amp;#x27;)\n\n    def check_result(expected: tuple, generated: tuple):\n        expected = numpy.array(expected).T\n        generated = numpy.array(generated).T\n    \n        print(expected)\n        print(generated)\n    \n        for column in expected:\n&amp;gt;           assert column in generated\nE           AssertionError: assert array([&amp;#x27;1999.97998046875&amp;#x27;], dtype=&amp;#x27;&amp;lt;U32&amp;#x27;) in array([[&amp;#x27;C005&amp;#x27;],\\n       [&amp;#x27;Giuseppe&amp;#x27;],\\n       [&amp;#x27;Ferrari&amp;#x27;],\\n       [&amp;#x27;999.989990234375&amp;#x27;]], dtype=&amp;#x27;&amp;lt;U32&amp;#x27;)\n\ntest_queries.py:46: AssertionError\n\n----------------------------- Captured stdout call -----------------------------\nPrompt Find the client who has spent the most on average per order\nExpected  SELECT customer_name, customer_surname, AVG(article_price * article_quantity) AS avg_spent_per_order FROM orders GROUP BY customer_name, customer_surname ORDER BY avg_spent_per_order DESC LIMIT 1\nGenerated SELECT o.customer_code, o.customer_name, o.customer_surname, AVG(o.article_price) AS average_price_per_order FROM orders o GROUP BY o.customer_code, o.customer_name, o.customer_surname ORDER BY average_price_per_order DESC NULLS LAST LIMIT 1;\n[[&amp;#x27;Giuseppe&amp;#x27;]\n [&amp;#x27;Ferrari&amp;#x27;]\n [&amp;#x27;1999.97998046875&amp;#x27;]]\n[[&amp;#x27;C005&amp;#x27;]\n [&amp;#x27;Giuseppe&amp;#x27;]\n [&amp;#x27;Ferrari&amp;#x27;]\n [&amp;#x27;999.989990234375&amp;#x27;]]\n&#34;}], &#34;test_queries.py::test_query_16&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_16&#34;, &#34;duration&#34;: &#34;00:00:54&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_16&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:54&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nPrompt List the top 5 articles with the highest total revenue generated, including the revenue amount\nExpected  SELECT article_name, SUM(article_price * article_quantity) AS total_revenue FROM orders GROUP BY article_name ORDER BY total_revenue DESC LIMIT 5\nGenerated SELECT o.article_code, o.article_name, SUM(o.article_quantity * o.article_price) AS total_revenue FROM orders o GROUP BY o.article_code, o.article_name ORDER BY total_revenue DESC NULLS LAST LIMIT 5;\n[[&amp;#x27;Laptop&amp;#x27; &amp;#x27;Printer&amp;#x27; &amp;#x27;Monitor&amp;#x27; &amp;#x27;Keyboard&amp;#x27; &amp;#x27;Mouse&amp;#x27;]\n [&amp;#x27;2999.969970703125&amp;#x27; &amp;#x27;599.7999877929688&amp;#x27; &amp;#x27;399.9800109863281&amp;#x27; &amp;#x27;225.0&amp;#x27;\n  &amp;#x27;76.5&amp;#x27;]]\n[[&amp;#x27;A001&amp;#x27; &amp;#x27;A005&amp;#x27; &amp;#x27;A004&amp;#x27; &amp;#x27;A003&amp;#x27; &amp;#x27;A002&amp;#x27;]\n [&amp;#x27;Laptop&amp;#x27; &amp;#x27;Printer&amp;#x27; &amp;#x27;Monitor&amp;#x27; &amp;#x27;Keyboard&amp;#x27; &amp;#x27;Mouse&amp;#x27;]\n [&amp;#x27;2999.969970703125&amp;#x27; &amp;#x27;599.7999877929688&amp;#x27; &amp;#x27;399.9800109863281&amp;#x27; &amp;#x27;225.0&amp;#x27;\n  &amp;#x27;76.5&amp;#x27;]]\n&#34;}], &#34;test_queries.py::test_query_17&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_17&#34;, &#34;duration&#34;: &#34;00:01:04&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_17&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:01:04&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;db_cursor = &amp;lt;cursor object at 0x000001E6F55D7140; closed: 0&amp;gt;\n\n    def test_query_17(db_cursor):\n&amp;gt;       run_test(\n            db_cursor,\n            prompt=&amp;quot;Find the difference in total revenue between the most and least expensive articles&amp;quot;,\n            expected_query=&amp;quot;SELECT MAX(total_revenue) - MIN(total_revenue) AS revenue_difference FROM (SELECT article_name, SUM(article_price * article_quantity) AS total_revenue FROM orders GROUP BY article_name) AS article_revenues&amp;quot;\n        )\n\ntest_queries.py:207: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ntest_queries.py:91: in run_test\n    check_result(expected_result, generated_result)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nexpected = array([[2923.4699707]]), generated = array([[974.49]])\n\n    def check_result(expected: tuple, generated: tuple):\n        expected = numpy.array(expected).T\n        generated = numpy.array(generated).T\n    \n        print(expected)\n        print(generated)\n    \n        for column in expected:\n&amp;gt;           assert column in generated\nE           assert array([2923.4699707]) in array([[974.49]])\n\ntest_queries.py:46: AssertionError\n\n----------------------------- Captured stdout call -----------------------------\nPrompt Find the difference in total revenue between the most and least expensive articles\nExpected  SELECT MAX(total_revenue) - MIN(total_revenue) AS revenue_difference FROM (SELECT article_name, SUM(article_price * article_quantity) AS total_revenue FROM orders GROUP BY article_name) AS article_revenues\nGenerated SELECT (MAX(o.article_price) - MIN(o.article_price)) AS revenue_difference FROM orders o;\n[[2923.4699707]]\n[[974.49]]\n&#34;}], &#34;test_queries.py::test_query_18&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_18&#34;, &#34;duration&#34;: &#34;00:00:45&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_18&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:45&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nPrompt Retrieve the average article quantity for each month of the year, based on order dates\nExpected  SELECT EXTRACT(MONTH FROM date) AS month, AVG(article_quantity) AS avg_quantity FROM orders GROUP BY EXTRACT(MONTH FROM date) ORDER BY month\nGenerated SELECT EXTRACT(MONTH FROM o.date) AS MONTH, AVG(o.article_quantity) AS average_quantity FROM orders o GROUP BY MONTH ORDER BY MONTH NULLS LAST;\n[[Decimal(&amp;#x27;8&amp;#x27;)]\n [Decimal(&amp;#x27;1.5000000000000000&amp;#x27;)]]\n[[Decimal(&amp;#x27;8&amp;#x27;)]\n [Decimal(&amp;#x27;1.5000000000000000&amp;#x27;)]]\n&#34;}], &#34;test_queries.py::test_query_19&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_19&#34;, &#34;duration&#34;: &#34;00:01:04&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_19&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:01:04&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;----------------------------- Captured stdout call -----------------------------\nPrompt Find the top 3 clients who have purchased the highest number of different articles\nExpected  SELECT customer_name, customer_surname, COUNT(DISTINCT article_name) AS unique_articles_purchased FROM orders GROUP BY customer_name, customer_surname ORDER BY unique_articles_purchased DESC LIMIT 3\nGenerated SELECT o.customer_code, o.customer_name, o.customer_surname, COUNT(DISTINCT o.article_code) AS num_articles_purchased FROM orders o GROUP BY o.customer_code, o.customer_name, o.customer_surname ORDER BY num_articles_purchased DESC NULLS LAST LIMIT 3;\n[[&amp;#x27;Luigi&amp;#x27; &amp;#x27;Giulia&amp;#x27; &amp;#x27;Mario&amp;#x27;]\n [&amp;#x27;Verdi&amp;#x27; &amp;#x27;Bianchi&amp;#x27; &amp;#x27;Rossi&amp;#x27;]\n [&amp;#x27;2&amp;#x27; &amp;#x27;2&amp;#x27; &amp;#x27;2&amp;#x27;]]\n[[&amp;#x27;C002&amp;#x27; &amp;#x27;C003&amp;#x27; &amp;#x27;C001&amp;#x27;]\n [&amp;#x27;Luigi&amp;#x27; &amp;#x27;Giulia&amp;#x27; &amp;#x27;Mario&amp;#x27;]\n [&amp;#x27;Verdi&amp;#x27; &amp;#x27;Bianchi&amp;#x27; &amp;#x27;Rossi&amp;#x27;]\n [&amp;#x27;2&amp;#x27; &amp;#x27;2&amp;#x27; &amp;#x27;2&amp;#x27;]]\n&#34;}], &#34;test_queries.py::test_query_20&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;test_queries.py::test_query_20&#34;, &#34;duration&#34;: &#34;00:01:43&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;test_queries.py::test_query_20&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:01:43&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;db_cursor = &amp;lt;cursor object at 0x000001E6F55D73E0; closed: 0&amp;gt;\n\n    def test_query_20(db_cursor):\n&amp;gt;       run_test(\n            db_cursor,\n            prompt=&amp;quot;Calculate the total revenue for orders where the article quantity is above the median quantity of all orders&amp;quot;,\n            expected_query=&amp;quot;SELECT SUM(article_price * article_quantity) AS total_revenue FROM orders WHERE article_quantity &amp;gt; (SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY article_quantity) FROM orders)&amp;quot;\n        )\n\ntest_queries.py:228: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ntest_queries.py:91: in run_test\n    check_result(expected_result, generated_result)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nexpected = array([[2650.82997131]]), generated = array([[1250.44]])\n\n    def check_result(expected: tuple, generated: tuple):\n        expected = numpy.array(expected).T\n        generated = numpy.array(generated).T\n    \n        print(expected)\n        print(generated)\n    \n        for column in expected:\n&amp;gt;           assert column in generated\nE           assert array([2650.82997131]) in array([[1250.44]])\n\ntest_queries.py:46: AssertionError\n\n----------------------------- Captured stdout call -----------------------------\nPrompt Calculate the total revenue for orders where the article quantity is above the median quantity of all orders\nExpected  SELECT SUM(article_price * article_quantity) AS total_revenue FROM orders WHERE article_quantity &amp;gt; (SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY article_quantity) FROM orders)\nGenerated SELECT SUM(o.article_price) AS total_revenue FROM orders o WHERE o.article_quantity &amp;gt; (SELECT AVG(o2.article_quantity) FROM orders o2);\n[[2650.82997131]]\n[[1250.44]]\n&#34;}]}, &#34;renderCollapsed&#34;: [&#34;passed&#34;], &#34;initialSort&#34;: &#34;result&#34;, &#34;title&#34;: &#34;report.html&#34;}"></div>
    <script>
      (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
const { getCollapsedCategory, setCollapsedIds } = require('./storage.js')

class DataManager {
    setManager(data) {
        const collapsedCategories = [...getCollapsedCategory(data.renderCollapsed)]
        const collapsedIds = []
        const tests = Object.values(data.tests).flat().map((test, index) => {
            const collapsed = collapsedCategories.includes(test.result.toLowerCase())
            const id = `test_${index}`
            if (collapsed) {
                collapsedIds.push(id)
            }
            return {
                ...test,
                id,
                collapsed,
            }
        })
        const dataBlob = { ...data, tests }
        this.data = { ...dataBlob }
        this.renderData = { ...dataBlob }
        setCollapsedIds(collapsedIds)
    }

    get allData() {
        return { ...this.data }
    }

    resetRender() {
        this.renderData = { ...this.data }
    }

    setRender(data) {
        this.renderData.tests = [...data]
    }

    toggleCollapsedItem(id) {
        this.renderData.tests = this.renderData.tests.map((test) =>
            test.id === id ? { ...test, collapsed: !test.collapsed } : test,
        )
    }

    set allCollapsed(collapsed) {
        this.renderData = { ...this.renderData, tests: [...this.renderData.tests.map((test) => (
            { ...test, collapsed }
        ))] }
    }

    get testSubset() {
        return [...this.renderData.tests]
    }

    get environment() {
        return this.renderData.environment
    }

    get initialSort() {
        return this.data.initialSort
    }
}

module.exports = {
    manager: new DataManager(),
}

},{"./storage.js":8}],2:[function(require,module,exports){
const mediaViewer = require('./mediaviewer.js')
const templateEnvRow = document.getElementById('template_environment_row')
const templateResult = document.getElementById('template_results-table__tbody')

function htmlToElements(html) {
    const temp = document.createElement('template')
    temp.innerHTML = html
    return temp.content.childNodes
}

const find = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return elem.querySelector(selector)
}

const findAll = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return [...elem.querySelectorAll(selector)]
}

const dom = {
    getStaticRow: (key, value) => {
        const envRow = templateEnvRow.content.cloneNode(true)
        const isObj = typeof value === 'object' && value !== null
        const values = isObj ? Object.keys(value).map((k) => `${k}: ${value[k]}`) : null

        const valuesElement = htmlToElements(
            values ? `<ul>${values.map((val) => `<li>${val}</li>`).join('')}<ul>` : `<div>${value}</div>`)[0]
        const td = findAll('td', envRow)
        td[0].textContent = key
        td[1].appendChild(valuesElement)

        return envRow
    },
    getResultTBody: ({ testId, id, log, extras, resultsTableRow, tableHtml, result, collapsed }) => {
        const resultBody = templateResult.content.cloneNode(true)
        resultBody.querySelector('tbody').classList.add(result.toLowerCase())
        resultBody.querySelector('tbody').id = testId
        resultBody.querySelector('.collapsible').dataset.id = id

        resultsTableRow.forEach((html) => {
            const t = document.createElement('template')
            t.innerHTML = html
            resultBody.querySelector('.collapsible').appendChild(t.content)
        })

        if (log) {
            // Wrap lines starting with "E" with span.error to color those lines red
            const wrappedLog = log.replace(/^E.*$/gm, (match) => `<span class="error">${match}</span>`)
            resultBody.querySelector('.log').innerHTML = wrappedLog
        } else {
            resultBody.querySelector('.log').remove()
        }

        if (collapsed) {
            resultBody.querySelector('.collapsible > td')?.classList.add('collapsed')
            resultBody.querySelector('.extras-row').classList.add('hidden')
        } else {
            resultBody.querySelector('.collapsible > td')?.classList.remove('collapsed')
        }

        const media = []
        extras?.forEach(({ name, format_type, content }) => {
            if (['image', 'video'].includes(format_type)) {
                media.push({ path: content, name, format_type })
            }

            if (format_type === 'html') {
                resultBody.querySelector('.extraHTML').insertAdjacentHTML('beforeend', `<div>${content}</div>`)
            }
        })
        mediaViewer.setup(resultBody, media)

        // Add custom html from the pytest_html_results_table_html hook
        tableHtml?.forEach((item) => {
            resultBody.querySelector('td[class="extra"]').insertAdjacentHTML('beforeend', item)
        })

        return resultBody
    },
}

module.exports = {
    dom,
    htmlToElements,
    find,
    findAll,
}

},{"./mediaviewer.js":6}],3:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const storageModule = require('./storage.js')

const getFilteredSubSet = (filter) =>
    manager.allData.tests.filter(({ result }) => filter.includes(result.toLowerCase()))

const doInitFilter = () => {
    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)
}

const doFilter = (type, show) => {
    if (show) {
        storageModule.showCategory(type)
    } else {
        storageModule.hideCategory(type)
    }

    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)

    const sortColumn = storageModule.getSort()
    doSort(sortColumn, true)
}

module.exports = {
    doFilter,
    doInitFilter,
}

},{"./datamanager.js":1,"./sort.js":7,"./storage.js":8}],4:[function(require,module,exports){
const { redraw, bindEvents, renderStatic } = require('./main.js')
const { doInitFilter } = require('./filter.js')
const { doInitSort } = require('./sort.js')
const { manager } = require('./datamanager.js')
const data = JSON.parse(document.getElementById('data-container').dataset.jsonblob)

function init() {
    manager.setManager(data)
    doInitFilter()
    doInitSort()
    renderStatic()
    redraw()
    bindEvents()
}

init()

},{"./datamanager.js":1,"./filter.js":3,"./main.js":5,"./sort.js":7}],5:[function(require,module,exports){
const { dom, find, findAll } = require('./dom.js')
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const { doFilter } = require('./filter.js')
const {
    getVisible,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    getSortDirection,
    possibleFilters,
} = require('./storage.js')

const removeChildren = (node) => {
    while (node.firstChild) {
        node.removeChild(node.firstChild)
    }
}

const renderStatic = () => {
    const renderEnvironmentTable = () => {
        const environment = manager.environment
        const rows = Object.keys(environment).map((key) => dom.getStaticRow(key, environment[key]))
        const table = document.getElementById('environment')
        removeChildren(table)
        rows.forEach((row) => table.appendChild(row))
    }
    renderEnvironmentTable()
}

const addItemToggleListener = (elem) => {
    elem.addEventListener('click', ({ target }) => {
        const id = target.parentElement.dataset.id
        manager.toggleCollapsedItem(id)

        const collapsedIds = getCollapsedIds()
        if (collapsedIds.includes(id)) {
            const updated = collapsedIds.filter((item) => item !== id)
            setCollapsedIds(updated)
        } else {
            collapsedIds.push(id)
            setCollapsedIds(collapsedIds)
        }
        redraw()
    })
}

const renderContent = (tests) => {
    const sortAttr = getSort(manager.initialSort)
    const sortAsc = JSON.parse(getSortDirection())
    const rows = tests.map(dom.getResultTBody)
    const table = document.getElementById('results-table')
    const tableHeader = document.getElementById('results-table-head')

    const newTable = document.createElement('table')
    newTable.id = 'results-table'

    // remove all sorting classes and set the relevant
    findAll('.sortable', tableHeader).forEach((elem) => elem.classList.remove('asc', 'desc'))
    tableHeader.querySelector(`.sortable[data-column-type="${sortAttr}"]`)?.classList.add(sortAsc ? 'desc' : 'asc')
    newTable.appendChild(tableHeader)

    if (!rows.length) {
        const emptyTable = document.getElementById('template_results-table__body--empty').content.cloneNode(true)
        newTable.appendChild(emptyTable)
    } else {
        rows.forEach((row) => {
            if (!!row) {
                findAll('.collapsible td:not(.col-links', row).forEach(addItemToggleListener)
                find('.logexpander', row).addEventListener('click',
                    (evt) => evt.target.parentNode.classList.toggle('expanded'),
                )
                newTable.appendChild(row)
            }
        })
    }

    table.replaceWith(newTable)
}

const renderDerived = () => {
    const currentFilter = getVisible()
    possibleFilters.forEach((result) => {
        const input = document.querySelector(`input[data-test-result="${result}"]`)
        input.checked = currentFilter.includes(result)
    })
}

const bindEvents = () => {
    const filterColumn = (evt) => {
        const { target: element } = evt
        const { testResult } = element.dataset

        doFilter(testResult, element.checked)
        const collapsedIds = getCollapsedIds()
        const updated = manager.renderData.tests.map((test) => {
            return {
                ...test,
                collapsed: collapsedIds.includes(test.id),
            }
        })
        manager.setRender(updated)
        redraw()
    }

    const header = document.getElementById('environment-header')
    header.addEventListener('click', () => {
        const table = document.getElementById('environment')
        table.classList.toggle('hidden')
        header.classList.toggle('collapsed')
    })

    findAll('input[name="filter_checkbox"]').forEach((elem) => {
        elem.addEventListener('click', filterColumn)
    })

    findAll('.sortable').forEach((elem) => {
        elem.addEventListener('click', (evt) => {
            const { target: element } = evt
            const { columnType } = element.dataset
            doSort(columnType)
            redraw()
        })
    })

    document.getElementById('show_all_details').addEventListener('click', () => {
        manager.allCollapsed = false
        setCollapsedIds([])
        redraw()
    })
    document.getElementById('hide_all_details').addEventListener('click', () => {
        manager.allCollapsed = true
        const allIds = manager.renderData.tests.map((test) => test.id)
        setCollapsedIds(allIds)
        redraw()
    })
}

const redraw = () => {
    const { testSubset } = manager

    renderContent(testSubset)
    renderDerived()
}

module.exports = {
    redraw,
    bindEvents,
    renderStatic,
}

},{"./datamanager.js":1,"./dom.js":2,"./filter.js":3,"./sort.js":7,"./storage.js":8}],6:[function(require,module,exports){
class MediaViewer {
    constructor(assets) {
        this.assets = assets
        this.index = 0
    }

    nextActive() {
        this.index = this.index === this.assets.length - 1 ? 0 : this.index + 1
        return [this.activeFile, this.index]
    }

    prevActive() {
        this.index = this.index === 0 ? this.assets.length - 1 : this.index -1
        return [this.activeFile, this.index]
    }

    get currentIndex() {
        return this.index
    }

    get activeFile() {
        return this.assets[this.index]
    }
}


const setup = (resultBody, assets) => {
    if (!assets.length) {
        resultBody.querySelector('.media').classList.add('hidden')
        return
    }

    const mediaViewer = new MediaViewer(assets)
    const container = resultBody.querySelector('.media-container')
    const leftArrow = resultBody.querySelector('.media-container__nav--left')
    const rightArrow = resultBody.querySelector('.media-container__nav--right')
    const mediaName = resultBody.querySelector('.media__name')
    const counter = resultBody.querySelector('.media__counter')
    const imageEl = resultBody.querySelector('img')
    const sourceEl = resultBody.querySelector('source')
    const videoEl = resultBody.querySelector('video')

    const setImg = (media, index) => {
        if (media?.format_type === 'image') {
            imageEl.src = media.path

            imageEl.classList.remove('hidden')
            videoEl.classList.add('hidden')
        } else if (media?.format_type === 'video') {
            sourceEl.src = media.path

            videoEl.classList.remove('hidden')
            imageEl.classList.add('hidden')
        }

        mediaName.innerText = media?.name
        counter.innerText = `${index + 1} / ${assets.length}`
    }
    setImg(mediaViewer.activeFile, mediaViewer.currentIndex)

    const moveLeft = () => {
        const [media, index] = mediaViewer.prevActive()
        setImg(media, index)
    }
    const doRight = () => {
        const [media, index] = mediaViewer.nextActive()
        setImg(media, index)
    }
    const openImg = () => {
        window.open(mediaViewer.activeFile.path, '_blank')
    }
    if (assets.length === 1) {
        container.classList.add('media-container--fullscreen')
    } else {
        leftArrow.addEventListener('click', moveLeft)
        rightArrow.addEventListener('click', doRight)
    }
    imageEl.addEventListener('click', openImg)
}

module.exports = {
    setup,
}

},{}],7:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const storageModule = require('./storage.js')

const genericSort = (list, key, ascending, customOrder) => {
    let sorted
    if (customOrder) {
        sorted = list.sort((a, b) => {
            const aValue = a.result.toLowerCase()
            const bValue = b.result.toLowerCase()

            const aIndex = customOrder.findIndex((item) => item.toLowerCase() === aValue)
            const bIndex = customOrder.findIndex((item) => item.toLowerCase() === bValue)

            // Compare the indices to determine the sort order
            return aIndex - bIndex
        })
    } else {
        sorted = list.sort((a, b) => a[key] === b[key] ? 0 : a[key] > b[key] ? 1 : -1)
    }

    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const durationSort = (list, ascending) => {
    const parseDuration = (duration) => {
        if (duration.includes(':')) {
            // If it's in the format "HH:mm:ss"
            const [hours, minutes, seconds] = duration.split(':').map(Number)
            return (hours * 3600 + minutes * 60 + seconds) * 1000
        } else {
            // If it's in the format "nnn ms"
            return parseInt(duration)
        }
    }
    const sorted = list.sort((a, b) => parseDuration(a['duration']) - parseDuration(b['duration']))
    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const doInitSort = () => {
    const type = storageModule.getSort(manager.initialSort)
    const ascending = storageModule.getSortDirection()
    const list = manager.testSubset
    const initialOrder = ['Error', 'Failed', 'Rerun', 'XFailed', 'XPassed', 'Skipped', 'Passed']

    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    if (type?.toLowerCase() === 'original') {
        manager.setRender(list)
    } else {
        let sortedList
        switch (type) {
        case 'duration':
            sortedList = durationSort(list, ascending)
            break
        case 'result':
            sortedList = genericSort(list, type, ascending, initialOrder)
            break
        default:
            sortedList = genericSort(list, type, ascending)
            break
        }
        manager.setRender(sortedList)
    }
}

const doSort = (type, skipDirection) => {
    const newSortType = storageModule.getSort(manager.initialSort) !== type
    const currentAsc = storageModule.getSortDirection()
    let ascending
    if (skipDirection) {
        ascending = currentAsc
    } else {
        ascending = newSortType ? false : !currentAsc
    }
    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    const list = manager.testSubset
    const sortedList = type === 'duration' ? durationSort(list, ascending) : genericSort(list, type, ascending)
    manager.setRender(sortedList)
}

module.exports = {
    doInitSort,
    doSort,
}

},{"./datamanager.js":1,"./storage.js":8}],8:[function(require,module,exports){
const possibleFilters = [
    'passed',
    'skipped',
    'failed',
    'error',
    'xfailed',
    'xpassed',
    'rerun',
]

const getVisible = () => {
    const url = new URL(window.location.href)
    const settings = new URLSearchParams(url.search).get('visible')
    const lower = (item) => {
        const lowerItem = item.toLowerCase()
        if (possibleFilters.includes(lowerItem)) {
            return lowerItem
        }
        return null
    }
    return settings === null ?
        possibleFilters :
        [...new Set(settings?.split(',').map(lower).filter((item) => item))]
}

const hideCategory = (categoryToHide) => {
    const url = new URL(window.location.href)
    const visibleParams = new URLSearchParams(url.search).get('visible')
    const currentVisible = visibleParams ? visibleParams.split(',') : [...possibleFilters]
    const settings = [...new Set(currentVisible)].filter((f) => f !== categoryToHide).join(',')

    url.searchParams.set('visible', settings)
    window.history.pushState({}, null, unescape(url.href))
}

const showCategory = (categoryToShow) => {
    if (typeof window === 'undefined') {
        return
    }
    const url = new URL(window.location.href)
    const currentVisible = new URLSearchParams(url.search).get('visible')?.split(',').filter(Boolean) ||
        [...possibleFilters]
    const settings = [...new Set([categoryToShow, ...currentVisible])]
    const noFilter = possibleFilters.length === settings.length || !settings.length

    noFilter ? url.searchParams.delete('visible') : url.searchParams.set('visible', settings.join(','))
    window.history.pushState({}, null, unescape(url.href))
}

const getSort = (initialSort) => {
    const url = new URL(window.location.href)
    let sort = new URLSearchParams(url.search).get('sort')
    if (!sort) {
        sort = initialSort || 'result'
    }
    return sort
}

const setSort = (type) => {
    const url = new URL(window.location.href)
    url.searchParams.set('sort', type)
    window.history.pushState({}, null, unescape(url.href))
}

const getCollapsedCategory = (renderCollapsed) => {
    let categories
    if (typeof window !== 'undefined') {
        const url = new URL(window.location.href)
        const collapsedItems = new URLSearchParams(url.search).get('collapsed')
        switch (true) {
        case !renderCollapsed && collapsedItems === null:
            categories = ['passed']
            break
        case collapsedItems?.length === 0 || /^["']{2}$/.test(collapsedItems):
            categories = []
            break
        case /^all$/.test(collapsedItems) || collapsedItems === null && /^all$/.test(renderCollapsed):
            categories = [...possibleFilters]
            break
        default:
            categories = collapsedItems?.split(',').map((item) => item.toLowerCase()) || renderCollapsed
            break
        }
    } else {
        categories = []
    }
    return categories
}

const getSortDirection = () => JSON.parse(sessionStorage.getItem('sortAsc')) || false
const setSortDirection = (ascending) => sessionStorage.setItem('sortAsc', ascending)

const getCollapsedIds = () => JSON.parse(sessionStorage.getItem('collapsedIds')) || []
const setCollapsedIds = (list) => sessionStorage.setItem('collapsedIds', JSON.stringify(list))

module.exports = {
    getVisible,
    hideCategory,
    showCategory,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    setSort,
    getSortDirection,
    setSortDirection,
    getCollapsedCategory,
    possibleFilters,
}

},{}]},{},[4]);
    </script>
  </footer>
</html>